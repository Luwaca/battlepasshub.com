<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Stats</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Protest+Strike:wght@400&display=swap">
    <link rel="stylesheet" href="../assets/styles/navbar.css">
    <link rel="stylesheet" href="../assets/styles/stats.css">
</head>
<body>
    <div class="nav-bar">
        <img class="bp" src="../assets/icons/BP.png" alt="BP Logo" />
        <a href="../index.html">
            <div class="home">
                <div class="text-wrapper-3">HOME</div>
            </div>
        </a>
        <a href="../Pages/overwatch.html">
            <div class="ow">
                <div class="overlap">
                    <div class="text-wrapper-2">OVERWATCH</div>
                </div>
            </div>
        </a>
        <a href="../Pages/fortnite.html">
            <div class="fortnite">
                <div class="overlap-group">
                    <div class="div">FORTNITE</div>
                </div>
            </div>
        </a>
        <a href="../Pages/player-stats.html">
            <div class="stats">
                <div class="text-wrapper">PLAYER STATS</div>
            </div>
        </a>
        <div class="search-container">
            <button id="search-button" class="search-button">
                <img src="../assets/icons/SearchBar.png" alt="Search">
            </button>
            <input type="text" id="search-input" class="search-input" placeholder="Search...">
        </div>
    </div>
    <div class="wrapper">
        <section class="player-stats-container">
            <div class="player-stats-card">
                <!-- Player Info -->
                <div class="player-info">
                    <div class="player-avatar" role="img" aria-label="Player avatar">
                        <img id="player-icon" src="../assets/icons/placeholder avatar.png" alt="?"/>
                    </div>
                    <span id="username" class="player-name">NAME</span>
                </div>
                <div class="namecard">
                    <img id="namecard" src="../assets/icons/playercard.png" alt="?">
                </div>
                <div class="title">
                    <span id="title"></span>
                </div>
                <div class="endorsement">
                    <img id="endorsement-icon" src="../assets/icons/endorsement.png" alt="?">
                </div>
                <!-- Stats Details -->
                <div class="stats-details">
                    <div class="stats-separator"></div>
                    <div class="roles-stats">
                        <div class="stats-content">
                            <div class="stats-main">
                                <div class="stats-data">
                                    <div class="stats-list">
                                        <div id="general-games-played" class="stats-item">PLAYED: N/A</div>
                                        <div id="general-games-won" class="stats-item">GAMES WON: N/A</div>
                                        <div id="general-games-lost" class="stats-item">GAMES LOST: N/A</div>
                                        <div id="general-time-played" class="stats-item-long">TIME PLAYED: N/A</div>
                                        <div id="general-winrate" class="stats-item">WIN RATE: N/A</div>
                                        <div id="general-kda" class="stats-item">KDA: N/A</div>
                                    </div>
                                    <div class="general-stats">
                                        <div class="general-stats-title">GENERAL</div>
                                        <div class="general-stats-list">
                                            <div id="general-total-eliminations" class="general-stats-item">ELIMS: N/A</div>
                                            <div id="general-total-assists" class="general-stats-item">ASSISTS: N/A</div>
                                            <div id="general-total-deaths" class="general-stats-item">DEATHS: N/A</div>
                                            <div id="general-total-damage" class="general-stats-item">DAMAGE: N/A</div>
                                            <div id="general-total-healing" class="general-stats-item">HEALING: N/A</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="role-icon" id="tank-button">
                                <button>
                                    <span class="role-name">TANK</span>
                                    <img loading="lazy" src="assests/Arrow 1.png" class="role-icon-img" alt="Tank role icon"/>
                                </button>
                            </div>
                            <div class="role-icon" id="supp-button">
                                <button>
                                    <span class="role-name">SUPP</span>
                                    <img loading="lazy" src="assests/Arrow 2.png" class="role-icon-img" alt="Support role icon"/>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
                    
                            <div class="role-icon" id="tank-button">
                                <button>
                                    <span class="role-name">TANK</span>
                                    <img loading="lazy" src="../assets/icons/Arrow 1.png" class="role-icon-img" alt="Tank role icon"/>
                                </button>
                            </div>
                            <div class="role-icon" id="supp-button">
                                <button>
                                    <span class="role-name">SUPP</span>
                                    <img loading="lazy" src="../assets/icons/Arrow 2.png" class="role-icon-img" alt="Support role icon"/>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
    
    <script>
document.getElementById('search-button').addEventListener('click', () => {
    const searchContainer = document.querySelector('.search-container');
    searchContainer.classList.toggle('expanded');
});

// Store recent searches in an array
let recentSearches = [];

document.getElementById('search-input').addEventListener('keypress', function(event) {
    if (event.key === 'Enter') {
        searchStats();
    }
});

async function fetchStatsSummary(playerId) {
    const response = await fetch(`https://overfast-api.tekrop.fr/players/${playerId}/stats/summary`);
    if (!response.ok) {
        throw new Error('Network response was not ok');
    }
    const data = await response.json();
    console.log('Stats Summary Data:', data); // Log the fetched data
    return data;
}


async function fetchSummary(playerId) {
    const response = await fetch(`https://overfast-api.tekrop.fr/players/${playerId}`);
    if (!response.ok) {
        throw new Error('Network response was not ok');
    }
    const data = await response.json();
    console.log('Summary Data:', data); // Log the fetched summary data
    return data;
}
async function searchStats() {
    let username = document.getElementById('search-input').value;
    const playerId = username.replace('#', '-'); // Replace # with -

    try {
        const summaryData = await fetchSummary(playerId);
        const statsData = await fetchStatsSummary(playerId); // Fetch stats summary data

        console.log('Fetched summary data:', summaryData);
        console.log('Fetched stats data:', statsData); // Log stats data

        if (summaryData && statsData) {
            // Update Player Info
            document.getElementById('username').textContent = summaryData.summary.username;
            document.getElementById('player-icon').src = summaryData.summary.avatar || 'default-icon-url';
            document.getElementById('namecard').src = summaryData.summary.namecard || 'default-namecard-url';
            document.getElementById('title').textContent = 'Title: ' + (summaryData.summary.title || 'N/A');
            document.getElementById('endorsement-icon').src = summaryData.summary.endorsement.frame || 'default-endorsement-icon-url';

            // Update stats with the fetched data
            updateStats(statsData);
        } else {
            document.getElementById('stats-content').innerText = 'Private Account or No Data Found';
        }
    } catch (error) {
        console.error('Error fetching summary or stats:', error);
        document.getElementById('stats-content').innerText = 'Private Account or Error Fetching Data';
    }
}


            function updateStats(statsData) {
    // Log the stats data
    console.log('Updating stats with data:', statsData);

    // Update General Stats
    document.getElementById('general-games-played').textContent = `PLAYED: ${statsData.general.games_played || 'N/A'}`;
    document.getElementById('general-games-won').textContent = `GAMES WON: ${statsData.general.games_won || 'N/A'}`;
    document.getElementById('general-games-lost').textContent = `GAMES LOST: ${statsData.general.games_lost || 'N/A'}`;
    document.getElementById('general-time-played').textContent = `TIME PLAYED: ${(statsData.general.time_played / 3600).toFixed(2) || 'N/A'} hrs`; // Convert seconds to hours
    document.getElementById('general-winrate').textContent = `WIN RATE: ${statsData.general.winrate || 'N/A'}`;
    document.getElementById('general-kda').textContent = `KDA: ${statsData.general.kda || 'N/A'}`;
    document.getElementById('general-total-eliminations').textContent = `ELIMS: ${statsData.general.total.eliminations || 'N/A'}`;
    document.getElementById('general-total-assists').textContent = `ASSISTS: ${statsData.general.total.assists || 'N/A'}`;
    document.getElementById('general-total-deaths').textContent = `DEATHS: ${statsData.general.total.deaths || 'N/A'}`;
    document.getElementById('general-total-damage').textContent = `DAMAGE: ${statsData.general.total.damage || 'N/A'}`;
    document.getElementById('general-total-healing').textContent = `HEALING: ${statsData.general.total.healing || 'N/A'}`;
            }

</script>
</body>s
</html>
